{
  "swagger": "2.0",
  "info": {
    "title": "Festivals API",
    "description": "API for managing festivals, cashless payments, tickets, and more. This API provides comprehensive endpoints for festival management including wallet operations, NFC payments, ticket scanning, and administrative functions.",
    "termsOfService": "https://festivals.io/terms",
    "contact": {
      "name": "API Support",
      "url": "https://festivals.io/support",
      "email": "support@festivals.io"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    },
    "version": "1.0.0"
  },
  "host": "localhost:8080",
  "basePath": "/api/v1",
  "schemes": ["http", "https"],
  "consumes": ["application/json"],
  "produces": ["application/json"],
  "securityDefinitions": {
    "BearerAuth": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header",
      "description": "JWT Authorization header using the Bearer scheme. Example: 'Authorization: Bearer {token}'"
    },
    "ApiKeyAuth": {
      "type": "apiKey",
      "name": "X-API-Key",
      "in": "header",
      "description": "API Key for external integrations"
    }
  },
  "tags": [
    {"name": "festivals", "description": "Festival management operations"},
    {"name": "wallets", "description": "Wallet and balance operations"},
    {"name": "payments", "description": "Payment processing"},
    {"name": "tickets", "description": "Ticket management and scanning"},
    {"name": "ticket-types", "description": "Ticket type configuration"},
    {"name": "products", "description": "Product catalog management"},
    {"name": "stands", "description": "Stand/vendor management"},
    {"name": "nfc", "description": "NFC tag and bracelet operations"},
    {"name": "refunds", "description": "Refund request management"},
    {"name": "sync", "description": "Offline transaction synchronization"},
    {"name": "lineup", "description": "Artist lineup management"},
    {"name": "stats", "description": "Statistics and analytics"},
    {"name": "users", "description": "User management"},
    {"name": "RBAC", "description": "Role-based access control"},
    {"name": "chat", "description": "Chatbot interactions"},
    {"name": "admin/chatbot", "description": "Chatbot administration"},
    {"name": "map", "description": "Festival map and POIs"},
    {"name": "inventory", "description": "Inventory management"},
    {"name": "api-keys", "description": "API key management"},
    {"name": "webhooks", "description": "Webhook configuration"}
  ],
  "paths": {
    "/festivals": {
      "get": {
        "tags": ["festivals"],
        "summary": "List festivals",
        "description": "Get a paginated list of all festivals",
        "operationId": "listFestivals",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "page", "in": "query", "type": "integer", "default": 1, "description": "Page number"},
          {"name": "per_page", "in": "query", "type": "integer", "default": 20, "description": "Items per page"}
        ],
        "responses": {
          "200": {
            "description": "List of festivals",
            "schema": {"$ref": "#/definitions/FestivalListResponse"}
          },
          "401": {"description": "Unauthorized", "schema": {"$ref": "#/definitions/ErrorResponse"}},
          "500": {"description": "Internal server error", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      },
      "post": {
        "tags": ["festivals"],
        "summary": "Create a new festival",
        "description": "Create a new festival with the provided information",
        "operationId": "createFestival",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {"$ref": "#/definitions/CreateFestivalRequest"}
          }
        ],
        "responses": {
          "201": {"description": "Festival created", "schema": {"$ref": "#/definitions/FestivalResponse"}},
          "400": {"description": "Invalid request", "schema": {"$ref": "#/definitions/ErrorResponse"}},
          "401": {"description": "Unauthorized", "schema": {"$ref": "#/definitions/ErrorResponse"}},
          "500": {"description": "Internal server error", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/festivals/{id}": {
      "get": {
        "tags": ["festivals"],
        "summary": "Get festival by ID",
        "description": "Get detailed information about a specific festival",
        "operationId": "getFestival",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid", "description": "Festival ID"}
        ],
        "responses": {
          "200": {"description": "Festival details", "schema": {"$ref": "#/definitions/FestivalResponse"}},
          "400": {"description": "Invalid ID", "schema": {"$ref": "#/definitions/ErrorResponse"}},
          "404": {"description": "Festival not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      },
      "patch": {
        "tags": ["festivals"],
        "summary": "Update festival",
        "description": "Update an existing festival with partial data",
        "operationId": "updateFestival",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"},
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/UpdateFestivalRequest"}}
        ],
        "responses": {
          "200": {"description": "Updated festival", "schema": {"$ref": "#/definitions/FestivalResponse"}},
          "400": {"description": "Invalid request", "schema": {"$ref": "#/definitions/ErrorResponse"}},
          "404": {"description": "Festival not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      },
      "delete": {
        "tags": ["festivals"],
        "summary": "Delete festival",
        "description": "Permanently delete a festival",
        "operationId": "deleteFestival",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "204": {"description": "Festival deleted"},
          "404": {"description": "Festival not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/festivals/{id}/activate": {
      "post": {
        "tags": ["festivals"],
        "summary": "Activate festival",
        "operationId": "activateFestival",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "Festival activated", "schema": {"$ref": "#/definitions/FestivalResponse"}},
          "404": {"description": "Festival not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/festivals/{id}/archive": {
      "post": {
        "tags": ["festivals"],
        "summary": "Archive festival",
        "operationId": "archiveFestival",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "Festival archived", "schema": {"$ref": "#/definitions/FestivalResponse"}},
          "404": {"description": "Festival not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/me/wallets": {
      "get": {
        "tags": ["wallets"],
        "summary": "Get user's wallets",
        "description": "Get all wallets belonging to the authenticated user",
        "operationId": "getMyWallets",
        "security": [{"BearerAuth": []}],
        "responses": {
          "200": {"description": "List of wallets", "schema": {"$ref": "#/definitions/WalletListResponse"}},
          "401": {"description": "Unauthorized", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/me/wallets/{festivalId}": {
      "get": {
        "tags": ["wallets"],
        "summary": "Get wallet for festival",
        "operationId": "getMyWalletForFestival",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "festivalId", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "Wallet details", "schema": {"$ref": "#/definitions/WalletResponse"}}
        }
      },
      "post": {
        "tags": ["wallets"],
        "summary": "Create wallet for festival",
        "operationId": "createMyWallet",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "festivalId", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "201": {"description": "Wallet created", "schema": {"$ref": "#/definitions/WalletResponse"}}
        }
      }
    },
    "/me/wallets/{festivalId}/qr": {
      "get": {
        "tags": ["wallets"],
        "summary": "Generate QR code for wallet",
        "operationId": "generateWalletQR",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "festivalId", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "QR code payload", "schema": {"$ref": "#/definitions/QRCodeResponse"}}
        }
      }
    },
    "/me/wallets/{festivalId}/transactions": {
      "get": {
        "tags": ["wallets"],
        "summary": "Get wallet transactions",
        "operationId": "getMyTransactions",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "festivalId", "in": "path", "required": true, "type": "string", "format": "uuid"},
          {"name": "page", "in": "query", "type": "integer", "default": 1},
          {"name": "per_page", "in": "query", "type": "integer", "default": 20}
        ],
        "responses": {
          "200": {"description": "Transaction list", "schema": {"$ref": "#/definitions/TransactionListResponse"}}
        }
      }
    },
    "/wallets/{id}": {
      "get": {
        "tags": ["wallets"],
        "summary": "Get wallet by ID (staff)",
        "operationId": "getWallet",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "Wallet details", "schema": {"$ref": "#/definitions/WalletResponse"}},
          "404": {"description": "Wallet not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/wallets/{id}/topup": {
      "post": {
        "tags": ["wallets"],
        "summary": "Top up wallet (staff)",
        "operationId": "topUpWallet",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"},
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/TopUpRequest"}}
        ],
        "responses": {
          "200": {"description": "Transaction created", "schema": {"$ref": "#/definitions/TransactionResponse"}}
        }
      }
    },
    "/wallets/{id}/freeze": {
      "post": {
        "tags": ["wallets"],
        "summary": "Freeze wallet (admin)",
        "operationId": "freezeWallet",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "Wallet frozen", "schema": {"$ref": "#/definitions/WalletResponse"}}
        }
      }
    },
    "/wallets/{id}/unfreeze": {
      "post": {
        "tags": ["wallets"],
        "summary": "Unfreeze wallet (admin)",
        "operationId": "unfreezeWallet",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "Wallet unfrozen", "schema": {"$ref": "#/definitions/WalletResponse"}}
        }
      }
    },
    "/payments": {
      "post": {
        "tags": ["payments"],
        "summary": "Process payment",
        "description": "Process a cashless payment at a stand",
        "operationId": "processPayment",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/PaymentRequest"}}
        ],
        "responses": {
          "200": {"description": "Payment processed", "schema": {"$ref": "#/definitions/TransactionResponse"}},
          "400": {"description": "Insufficient balance or invalid request", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/payments/validate-qr": {
      "post": {
        "tags": ["payments"],
        "summary": "Validate QR code",
        "operationId": "validateQR",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"type": "object", "properties": {"qrCode": {"type": "string"}}}}
        ],
        "responses": {
          "200": {"description": "Wallet info", "schema": {"$ref": "#/definitions/WalletResponse"}},
          "400": {"description": "Invalid QR code", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/payments/refund": {
      "post": {
        "tags": ["payments"],
        "summary": "Refund payment",
        "operationId": "refundPayment",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/RefundRequest"}}
        ],
        "responses": {
          "200": {"description": "Refund processed", "schema": {"$ref": "#/definitions/TransactionResponse"}}
        }
      }
    },
    "/nfc/activate": {
      "post": {
        "tags": ["nfc"],
        "summary": "Activate NFC tag",
        "description": "Activate an NFC tag and link it to a wallet",
        "operationId": "activateNFCTag",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/NFCActivationRequest"}}
        ],
        "responses": {
          "201": {"description": "Tag activated", "schema": {"$ref": "#/definitions/NFCTagResponse"}},
          "404": {"description": "Wallet not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/nfc/{uid}": {
      "get": {
        "tags": ["nfc"],
        "summary": "Get NFC tag",
        "operationId": "getNFCTag",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "uid", "in": "path", "required": true, "type": "string"}
        ],
        "responses": {
          "200": {"description": "Tag details", "schema": {"$ref": "#/definitions/NFCTagResponse"}},
          "404": {"description": "Tag not found", "schema": {"$ref": "#/definitions/ErrorResponse"}}
        }
      }
    },
    "/nfc/{uid}/deactivate": {
      "post": {
        "tags": ["nfc"],
        "summary": "Deactivate NFC tag",
        "operationId": "deactivateNFCTag",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "uid", "in": "path", "required": true, "type": "string"}
        ],
        "responses": {
          "200": {"description": "Tag deactivated", "schema": {"$ref": "#/definitions/NFCTagResponse"}}
        }
      }
    },
    "/nfc/{uid}/block": {
      "post": {
        "tags": ["nfc"],
        "summary": "Block NFC tag",
        "operationId": "blockNFCTag",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "uid", "in": "path", "required": true, "type": "string"},
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/NFCBlockRequest"}}
        ],
        "responses": {
          "200": {"description": "Tag blocked", "schema": {"$ref": "#/definitions/NFCTagResponse"}}
        }
      }
    },
    "/nfc/{uid}/validate": {
      "post": {
        "tags": ["nfc"],
        "summary": "Validate NFC tag for payment",
        "operationId": "validateNFCTag",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "uid", "in": "path", "required": true, "type": "string"},
          {"name": "body", "in": "body", "required": true, "schema": {"type": "object", "properties": {"amount": {"type": "integer"}}}}
        ],
        "responses": {
          "200": {"description": "Validation result", "schema": {"$ref": "#/definitions/NFCValidationResult"}}
        }
      }
    },
    "/tickets": {
      "get": {
        "tags": ["tickets"],
        "summary": "List tickets",
        "operationId": "listTickets",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "festivalId", "in": "query", "required": true, "type": "string", "format": "uuid"},
          {"name": "ticketTypeId", "in": "query", "type": "string", "format": "uuid"},
          {"name": "status", "in": "query", "type": "string"},
          {"name": "page", "in": "query", "type": "integer", "default": 1},
          {"name": "per_page", "in": "query", "type": "integer", "default": 20}
        ],
        "responses": {
          "200": {"description": "Ticket list", "schema": {"$ref": "#/definitions/TicketListResponse"}}
        }
      },
      "post": {
        "tags": ["tickets"],
        "summary": "Create ticket",
        "operationId": "createTicket",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/CreateTicketRequest"}}
        ],
        "responses": {
          "201": {"description": "Ticket created", "schema": {"$ref": "#/definitions/TicketResponse"}}
        }
      }
    },
    "/tickets/scan": {
      "post": {
        "tags": ["tickets"],
        "summary": "Scan/validate ticket",
        "operationId": "scanTicket",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/ScanTicketRequest"}}
        ],
        "responses": {
          "200": {"description": "Scan result", "schema": {"$ref": "#/definitions/ScanResponse"}}
        }
      }
    },
    "/me/tickets": {
      "get": {
        "tags": ["tickets"],
        "summary": "Get my tickets",
        "operationId": "getMyTickets",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "festivalId", "in": "query", "type": "string", "format": "uuid"},
          {"name": "status", "in": "query", "type": "string"},
          {"name": "page", "in": "query", "type": "integer", "default": 1},
          {"name": "per_page", "in": "query", "type": "integer", "default": 20}
        ],
        "responses": {
          "200": {"description": "User's tickets", "schema": {"$ref": "#/definitions/TicketListResponse"}}
        }
      }
    },
    "/me/refunds": {
      "get": {
        "tags": ["refunds"],
        "summary": "Get my refund requests",
        "operationId": "getMyRefunds",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "page", "in": "query", "type": "integer", "default": 1},
          {"name": "per_page", "in": "query", "type": "integer", "default": 20}
        ],
        "responses": {
          "200": {"description": "Refund list", "schema": {"$ref": "#/definitions/RefundListResponse"}}
        }
      },
      "post": {
        "tags": ["refunds"],
        "summary": "Request refund",
        "operationId": "requestRefund",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/CreateRefundInput"}}
        ],
        "responses": {
          "201": {"description": "Refund request created", "schema": {"$ref": "#/definitions/RefundResponse"}}
        }
      }
    },
    "/refunds/{id}/approve": {
      "post": {
        "tags": ["refunds"],
        "summary": "Approve refund (admin)",
        "operationId": "approveRefund",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"}
        ],
        "responses": {
          "200": {"description": "Refund approved", "schema": {"$ref": "#/definitions/RefundResponse"}}
        }
      }
    },
    "/refunds/{id}/reject": {
      "post": {
        "tags": ["refunds"],
        "summary": "Reject refund (admin)",
        "operationId": "rejectRefund",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "id", "in": "path", "required": true, "type": "string", "format": "uuid"},
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/RejectRefundInput"}}
        ],
        "responses": {
          "200": {"description": "Refund rejected", "schema": {"$ref": "#/definitions/RefundResponse"}}
        }
      }
    },
    "/sync/batch": {
      "post": {
        "tags": ["sync"],
        "summary": "Submit offline transaction batch",
        "operationId": "submitBatch",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {"name": "body", "in": "body", "required": true, "schema": {"$ref": "#/definitions/SubmitBatchRequest"}}
        ],
        "responses": {
          "200": {"description": "Batch processed", "schema": {"$ref": "#/definitions/SyncResult"}}
        }
      }
    },
    "/health": {
      "get": {
        "tags": ["system"],
        "summary": "Health check",
        "operationId": "healthCheck",
        "responses": {
          "200": {
            "description": "Service is healthy",
            "schema": {
              "type": "object",
              "properties": {
                "status": {"type": "string", "example": "ok"},
                "version": {"type": "string", "example": "1.0.0"}
              }
            }
          }
        }
      }
    }
  },
  "definitions": {
    "Response": {
      "type": "object",
      "properties": {
        "data": {"type": "object"},
        "meta": {"$ref": "#/definitions/Meta"}
      }
    },
    "Meta": {
      "type": "object",
      "properties": {
        "total": {"type": "integer"},
        "page": {"type": "integer"},
        "per_page": {"type": "integer"}
      }
    },
    "ErrorResponse": {
      "type": "object",
      "properties": {
        "error": {"$ref": "#/definitions/ErrorDetail"}
      }
    },
    "ErrorDetail": {
      "type": "object",
      "properties": {
        "code": {"type": "string"},
        "message": {"type": "string"},
        "details": {"type": "object"}
      }
    },
    "CreateFestivalRequest": {
      "type": "object",
      "required": ["name", "startDate", "endDate", "location"],
      "properties": {
        "name": {"type": "string", "example": "Summer Music Festival 2024"},
        "description": {"type": "string"},
        "startDate": {"type": "string", "format": "date-time"},
        "endDate": {"type": "string", "format": "date-time"},
        "location": {"type": "string"},
        "timezone": {"type": "string", "default": "UTC"},
        "currencyName": {"type": "string", "default": "Jetons"},
        "exchangeRate": {"type": "number", "default": 0.10}
      }
    },
    "UpdateFestivalRequest": {
      "type": "object",
      "properties": {
        "name": {"type": "string"},
        "description": {"type": "string"},
        "startDate": {"type": "string", "format": "date-time"},
        "endDate": {"type": "string", "format": "date-time"},
        "location": {"type": "string"}
      }
    },
    "FestivalResponse": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "name": {"type": "string"},
        "description": {"type": "string"},
        "startDate": {"type": "string", "format": "date-time"},
        "endDate": {"type": "string", "format": "date-time"},
        "location": {"type": "string"},
        "status": {"type": "string", "enum": ["draft", "active", "archived"]},
        "currencyName": {"type": "string"},
        "exchangeRate": {"type": "number"},
        "createdAt": {"type": "string", "format": "date-time"},
        "updatedAt": {"type": "string", "format": "date-time"}
      }
    },
    "FestivalListResponse": {
      "type": "object",
      "properties": {
        "data": {"type": "array", "items": {"$ref": "#/definitions/FestivalResponse"}},
        "meta": {"$ref": "#/definitions/Meta"}
      }
    },
    "WalletResponse": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "userId": {"type": "string", "format": "uuid"},
        "festivalId": {"type": "string", "format": "uuid"},
        "balance": {"type": "integer", "description": "Balance in cents"},
        "status": {"type": "string", "enum": ["active", "frozen"]},
        "createdAt": {"type": "string", "format": "date-time"}
      }
    },
    "WalletListResponse": {
      "type": "object",
      "properties": {
        "data": {"type": "array", "items": {"$ref": "#/definitions/WalletResponse"}}
      }
    },
    "TopUpRequest": {
      "type": "object",
      "required": ["amount"],
      "properties": {
        "amount": {"type": "integer", "minimum": 1, "description": "Amount in cents"},
        "paymentMethod": {"type": "string", "enum": ["cash", "card", "mobile"]}
      }
    },
    "TransactionResponse": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "walletId": {"type": "string", "format": "uuid"},
        "type": {"type": "string", "enum": ["topup", "payment", "refund"]},
        "amount": {"type": "integer"},
        "balanceBefore": {"type": "integer"},
        "balanceAfter": {"type": "integer"},
        "standId": {"type": "string", "format": "uuid"},
        "createdAt": {"type": "string", "format": "date-time"}
      }
    },
    "TransactionListResponse": {
      "type": "object",
      "properties": {
        "data": {"type": "array", "items": {"$ref": "#/definitions/TransactionResponse"}},
        "meta": {"$ref": "#/definitions/Meta"}
      }
    },
    "QRCodeResponse": {
      "type": "object",
      "properties": {
        "qrCode": {"type": "string"},
        "balance": {"type": "integer"},
        "expiresAt": {"type": "string", "format": "date-time"}
      }
    },
    "PaymentRequest": {
      "type": "object",
      "required": ["walletId", "amount", "standId"],
      "properties": {
        "walletId": {"type": "string", "format": "uuid"},
        "amount": {"type": "integer", "minimum": 1},
        "standId": {"type": "string", "format": "uuid"},
        "items": {"type": "array", "items": {"$ref": "#/definitions/PaymentItem"}}
      }
    },
    "PaymentItem": {
      "type": "object",
      "properties": {
        "productId": {"type": "string", "format": "uuid"},
        "quantity": {"type": "integer"},
        "price": {"type": "integer"}
      }
    },
    "RefundRequest": {
      "type": "object",
      "required": ["transactionId"],
      "properties": {
        "transactionId": {"type": "string", "format": "uuid"},
        "amount": {"type": "integer", "description": "Partial refund amount, omit for full refund"},
        "reason": {"type": "string"}
      }
    },
    "NFCActivationRequest": {
      "type": "object",
      "required": ["uid", "walletId"],
      "properties": {
        "uid": {"type": "string"},
        "walletId": {"type": "string", "format": "uuid"},
        "initialBalance": {"type": "integer", "default": 0}
      }
    },
    "NFCBlockRequest": {
      "type": "object",
      "required": ["reason"],
      "properties": {
        "reason": {"type": "string"}
      }
    },
    "NFCTagResponse": {
      "type": "object",
      "properties": {
        "uid": {"type": "string"},
        "walletId": {"type": "string", "format": "uuid"},
        "festivalId": {"type": "string", "format": "uuid"},
        "status": {"type": "string", "enum": ["inactive", "active", "blocked"]},
        "activatedAt": {"type": "string", "format": "date-time"},
        "balance": {"type": "integer"}
      }
    },
    "NFCValidationResult": {
      "type": "object",
      "properties": {
        "valid": {"type": "boolean"},
        "walletId": {"type": "string", "format": "uuid"},
        "balance": {"type": "integer"},
        "sufficientFunds": {"type": "boolean"},
        "message": {"type": "string"}
      }
    },
    "CreateTicketRequest": {
      "type": "object",
      "required": ["ticketTypeId"],
      "properties": {
        "ticketTypeId": {"type": "string", "format": "uuid"},
        "userId": {"type": "string", "format": "uuid"},
        "holderName": {"type": "string"},
        "holderEmail": {"type": "string", "format": "email"}
      }
    },
    "TicketResponse": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "code": {"type": "string"},
        "ticketTypeId": {"type": "string", "format": "uuid"},
        "userId": {"type": "string", "format": "uuid"},
        "status": {"type": "string", "enum": ["valid", "used", "cancelled", "expired"]},
        "holderName": {"type": "string"},
        "holderEmail": {"type": "string"},
        "scannedAt": {"type": "string", "format": "date-time"},
        "createdAt": {"type": "string", "format": "date-time"}
      }
    },
    "TicketListResponse": {
      "type": "object",
      "properties": {
        "data": {"type": "array", "items": {"$ref": "#/definitions/TicketResponse"}},
        "meta": {"$ref": "#/definitions/Meta"}
      }
    },
    "ScanTicketRequest": {
      "type": "object",
      "required": ["code"],
      "properties": {
        "code": {"type": "string"},
        "scanType": {"type": "string", "enum": ["entry", "exit"], "default": "entry"}
      }
    },
    "ScanResponse": {
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "result": {"type": "string", "enum": ["valid", "invalid", "already_used", "expired"]},
        "message": {"type": "string"},
        "ticket": {"$ref": "#/definitions/TicketResponse"},
        "scannedAt": {"type": "string", "format": "date-time"}
      }
    },
    "CreateRefundInput": {
      "type": "object",
      "required": ["walletId"],
      "properties": {
        "walletId": {"type": "string", "format": "uuid"},
        "amount": {"type": "integer"},
        "iban": {"type": "string"},
        "accountHolder": {"type": "string"}
      }
    },
    "RejectRefundInput": {
      "type": "object",
      "required": ["reason"],
      "properties": {
        "reason": {"type": "string"}
      }
    },
    "RefundResponse": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "userId": {"type": "string", "format": "uuid"},
        "walletId": {"type": "string", "format": "uuid"},
        "amount": {"type": "integer"},
        "status": {"type": "string", "enum": ["pending", "approved", "processing", "completed", "rejected"]},
        "requestedAt": {"type": "string", "format": "date-time"},
        "processedAt": {"type": "string", "format": "date-time"}
      }
    },
    "RefundListResponse": {
      "type": "object",
      "properties": {
        "data": {"type": "array", "items": {"$ref": "#/definitions/RefundResponse"}},
        "meta": {"$ref": "#/definitions/Meta"}
      }
    },
    "SubmitBatchRequest": {
      "type": "object",
      "required": ["transactions"],
      "properties": {
        "deviceId": {"type": "string"},
        "transactions": {"type": "array", "items": {"$ref": "#/definitions/OfflineTransaction"}}
      }
    },
    "OfflineTransaction": {
      "type": "object",
      "required": ["localId", "walletId", "amount", "signature"],
      "properties": {
        "localId": {"type": "string"},
        "walletId": {"type": "string", "format": "uuid"},
        "amount": {"type": "integer"},
        "standId": {"type": "string", "format": "uuid"},
        "timestamp": {"type": "string", "format": "date-time"},
        "signature": {"type": "string"}
      }
    },
    "SyncResult": {
      "type": "object",
      "properties": {
        "batchId": {"type": "string", "format": "uuid"},
        "status": {"type": "string", "enum": ["success", "partial", "failed"]},
        "processed": {"type": "integer"},
        "failed": {"type": "integer"},
        "errors": {"type": "array", "items": {"$ref": "#/definitions/SyncError"}}
      }
    },
    "SyncError": {
      "type": "object",
      "properties": {
        "localId": {"type": "string"},
        "code": {"type": "string"},
        "message": {"type": "string"}
      }
    }
  }
}
