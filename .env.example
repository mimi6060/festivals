# ==============================================================================
# FESTIVALS PROJECT - MASTER ENVIRONMENT CONFIGURATION
# ==============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# IMPORTANT: Never commit .env files with real credentials to version control!
#
# SECURITY NOTE: Variables marked [REQUIRED] will cause the application to fail
# if not set. Generate secure secrets using: openssl rand -base64 64
#
# Legend:
#   [REQUIRED] - Must be set for the application to work (will fail otherwise)
#   [OPTIONAL] - Has a sensible default, override if needed
#   [PRODUCTION] - Must be changed for production deployments
#   [SECURITY] - Security-critical, generate unique secure values
# ==============================================================================


# ==============================================================================
# APPLICATION SETTINGS
# ==============================================================================

# [OPTIONAL] Server port for the backend API
PORT=8080

# [REQUIRED] Environment mode: development, staging, production
ENVIRONMENT=development

# [OPTIONAL] Log level: debug, info, warn, error
LOG_LEVEL=info

# [OPTIONAL] Enable debug mode (verbose logging, stack traces)
DEBUG=false

# [OPTIONAL] Application name (used in logs and notifications)
APP_NAME=Festivals

# [OPTIONAL] Base URL for the application (used for generating links)
APP_URL=http://localhost:8080


# ==============================================================================
# DATABASE (PostgreSQL)
# ==============================================================================

# [REQUIRED] PostgreSQL connection URL
# Format: postgres://user:password@host:port/database?sslmode=disable
DATABASE_URL=postgres://festivals:password@localhost:5432/festivals?sslmode=disable

# [REQUIRED] Individual database settings (used by docker-compose)
# SECURITY: You MUST set POSTGRES_USER and POSTGRES_PASSWORD - no defaults!
# Generate a secure password: openssl rand -base64 32
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=festivals
POSTGRES_PASSWORD=
POSTGRES_DB=festivals

# [OPTIONAL] Connection pool settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m


# ==============================================================================
# REDIS (Cache & Queue)
# ==============================================================================

# [REQUIRED] Redis connection URL
# Format: redis://[:password@]host:port[/database]
REDIS_URL=redis://localhost:6379

# [OPTIONAL] Individual Redis settings (alternative to REDIS_URL)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# [OPTIONAL] Redis connection pool size
REDIS_POOL_SIZE=10


# ==============================================================================
# AUTH0 AUTHENTICATION
# ==============================================================================

# [REQUIRED] Your Auth0 tenant domain (e.g., your-tenant.us.auth0.com)
AUTH0_DOMAIN=your-tenant.eu.auth0.com

# [REQUIRED] API audience/identifier configured in Auth0
AUTH0_AUDIENCE=https://api.festivals.app

# [REQUIRED] Auth0 application client ID
AUTH0_CLIENT_ID=your-auth0-client-id

# [REQUIRED] Auth0 application client secret
AUTH0_CLIENT_SECRET=your-auth0-client-secret

# [REQUIRED] Random secret for NextAuth.js session encryption (min 32 chars)
# Generate with: openssl rand -base64 32
AUTH0_SECRET=generate-a-random-32-character-secret-here

# [OPTIONAL] Auth0 Management API settings (for user management)
AUTH0_MGMT_CLIENT_ID=your-mgmt-api-client-id
AUTH0_MGMT_CLIENT_SECRET=your-mgmt-api-client-secret


# ==============================================================================
# JWT / SECURITY
# ==============================================================================

# [REQUIRED] [SECURITY] Secret key for signing internal JWTs
# SECURITY: This MUST be set - no default value. Minimum 32 characters.
# Generate with: openssl rand -base64 64
JWT_SECRET=

# [REQUIRED] [SECURITY] Secret key for signing QR codes
# SECURITY: This MUST be set - no default value. Minimum 32 characters.
# Generate with: openssl rand -base64 64
QRCODE_SECRET=

# [OPTIONAL] JWT token expiration time
JWT_EXPIRATION=24h

# [OPTIONAL] JWT refresh token expiration time
JWT_REFRESH_EXPIRATION=168h

# [OPTIONAL] Allowed origins for CORS (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8081

# [OPTIONAL] API key for internal service-to-service communication
INTERNAL_API_KEY=your-internal-api-key


# ==============================================================================
# STRIPE PAYMENTS
# ==============================================================================

# [REQUIRED] Stripe secret key (starts with sk_test_ or sk_live_)
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key

# [REQUIRED] Stripe publishable key (for frontend)
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key

# [REQUIRED] Stripe webhook signing secret (starts with whsec_)
# Get this from Stripe Dashboard > Webhooks
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-signing-secret

# [OPTIONAL] Stripe Connect settings for marketplace payments
STRIPE_CONNECT_CLIENT_ID=ca_your-connect-client-id
STRIPE_CONNECT_WEBHOOK_SECRET=whsec_your-connect-webhook-secret

# [OPTIONAL] Default currency for payments (ISO 4217)
STRIPE_DEFAULT_CURRENCY=eur

# [OPTIONAL] Platform fee percentage for Stripe Connect (e.g., 0.05 for 5%)
STRIPE_PLATFORM_FEE_PERCENT=0.05


# ==============================================================================
# MINIO / S3 OBJECT STORAGE
# ==============================================================================

# [REQUIRED] MinIO/S3 endpoint URL (without protocol for MinIO)
MINIO_ENDPOINT=localhost:9000

# [REQUIRED] [SECURITY] MinIO/S3 access key - MUST be set, no default
MINIO_ACCESS_KEY=

# [REQUIRED] [SECURITY] MinIO/S3 secret key - MUST be set, no default
# Generate with: openssl rand -base64 32
MINIO_SECRET_KEY=

# [REQUIRED] Default bucket name for file uploads
MINIO_BUCKET=festivals

# [OPTIONAL] Use SSL for MinIO connection
MINIO_USE_SSL=false

# [OPTIONAL] MinIO region (for S3 compatibility)
MINIO_REGION=us-east-1

# [REQUIRED] [SECURITY] MinIO root credentials (for docker-compose)
# SECURITY: These MUST be set - no defaults! Use strong unique values.
MINIO_ROOT_USER=
MINIO_ROOT_PASSWORD=

# [OPTIONAL] Public URL for accessing stored files
STORAGE_PUBLIC_URL=http://localhost:9000/festivals


# ==============================================================================
# EMAIL SERVICE
# ==============================================================================

# [OPTIONAL] Email provider: postal, sendgrid, smtp, mailgun
EMAIL_PROVIDER=postal

# --- Postal (Self-hosted) ---
# [OPTIONAL] Postal server URL
POSTAL_URL=http://localhost:5000

# [OPTIONAL] Postal API key
POSTAL_API_KEY=your-postal-api-key

# --- SendGrid ---
# [OPTIONAL] SendGrid API key
SENDGRID_API_KEY=SG.your-sendgrid-api-key

# --- SMTP (Generic) ---
# [OPTIONAL] SMTP server settings
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your-smtp-username
SMTP_PASSWORD=your-smtp-password
SMTP_FROM_EMAIL=noreply@festivals.app
SMTP_FROM_NAME=Festivals App

# --- Mailgun ---
# [OPTIONAL] Mailgun settings
MAILGUN_API_KEY=your-mailgun-api-key
MAILGUN_DOMAIN=mg.festivals.app


# ==============================================================================
# SMS SERVICE (Twilio)
# ==============================================================================

# [OPTIONAL] Twilio Account SID
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# [OPTIONAL] Twilio Auth Token
TWILIO_AUTH_TOKEN=your-twilio-auth-token

# [OPTIONAL] Twilio phone number for sending SMS
TWILIO_FROM_NUMBER=+1234567890

# [OPTIONAL] SMS rate limit (messages per second, 0 for no limit)
TWILIO_RATE_LIMIT=10


# ==============================================================================
# PUSH NOTIFICATIONS
# ==============================================================================

# --- Expo Push Notifications ---
# [OPTIONAL] Expo access token for push notifications
EXPO_ACCESS_TOKEN=your-expo-access-token

# --- Firebase Cloud Messaging (FCM) ---
# [OPTIONAL] FCM server key (legacy) or service account JSON path
FCM_SERVER_KEY=your-fcm-server-key
FCM_SERVICE_ACCOUNT_PATH=./config/firebase-service-account.json

# --- Apple Push Notification Service (APNs) ---
# [OPTIONAL] APNs settings
APNS_KEY_ID=your-apns-key-id
APNS_TEAM_ID=your-apple-team-id
APNS_KEY_PATH=./config/apns-auth-key.p8
APNS_BUNDLE_ID=com.festivals.app
APNS_PRODUCTION=false


# ==============================================================================
# OPENAI / AI SERVICES
# ==============================================================================

# [OPTIONAL] OpenAI API key for AI-powered features
OPENAI_API_KEY=sk-your-openai-api-key

# [OPTIONAL] OpenAI model for chat completions
OPENAI_MODEL=gpt-4o

# [OPTIONAL] OpenAI model for embeddings
OPENAI_EMBED_MODEL=text-embedding-3-small


# ==============================================================================
# FEATURE FLAGS
# ==============================================================================

# [OPTIONAL] Enable/disable specific features
FEATURE_NFC_PAYMENTS=true
FEATURE_WALLET_TOPUP=true
FEATURE_ARTIST_LINEUP=true
FEATURE_LIVE_CHAT=true
FEATURE_AI_CHATBOT=true
FEATURE_PUSH_NOTIFICATIONS=true
FEATURE_ANALYTICS=true
FEATURE_MULTI_LANGUAGE=true


# ==============================================================================
# RATE LIMITING
# ==============================================================================

# [OPTIONAL] Global API rate limit (requests per minute per IP)
RATE_LIMIT_REQUESTS_PER_MINUTE=100

# [OPTIONAL] Auth endpoint rate limit (requests per minute per IP)
RATE_LIMIT_AUTH_PER_MINUTE=10

# [OPTIONAL] Enable rate limiting
RATE_LIMIT_ENABLED=true

# [OPTIONAL] Rate limit storage backend: memory, redis
RATE_LIMIT_STORE=redis


# ==============================================================================
# MONITORING & OBSERVABILITY
# ==============================================================================

# --- Sentry Error Tracking ---
# [OPTIONAL] Sentry DSN for error tracking
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# [OPTIONAL] Sentry environment tag
SENTRY_ENVIRONMENT=development

# [OPTIONAL] Sample rate for Sentry performance monitoring (0.0 to 1.0)
SENTRY_TRACES_SAMPLE_RATE=0.1

# --- Prometheus Metrics ---
# [OPTIONAL] Enable Prometheus metrics endpoint
METRICS_ENABLED=true

# [OPTIONAL] Metrics endpoint port (separate from main API)
METRICS_PORT=9090

# --- Health Checks ---
# [OPTIONAL] Enable health check endpoint
HEALTH_CHECK_ENABLED=true

# --- Grafana Dashboard ---
# [REQUIRED for monitoring stack] [SECURITY] Grafana admin credentials
# SECURITY: Change GRAFANA_ADMIN_PASSWORD in production!
# Generate with: openssl rand -base64 32
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=

# [OPTIONAL] Grafana root URL (for proper link generation)
GRAFANA_ROOT_URL=http://localhost:3001


# ==============================================================================
# ADMIN DASHBOARD (Next.js)
# ==============================================================================

# [OPTIONAL] Node environment
NODE_ENV=development

# [REQUIRED] Backend API URL (for server-side requests)
NEXT_PUBLIC_API_URL=http://localhost:8080

# [OPTIONAL] WebSocket URL for real-time features
NEXT_PUBLIC_WS_URL=ws://localhost:8080/ws

# [REQUIRED] Auth0 base URL (your admin dashboard URL)
AUTH0_BASE_URL=http://localhost:3000

# [REQUIRED] Auth0 issuer URL
AUTH0_ISSUER_BASE_URL=https://your-tenant.eu.auth0.com

# [OPTIONAL] Stripe publishable key (for frontend payment forms)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key

# [OPTIONAL] Auth0 domain for frontend (without https://)
NEXT_PUBLIC_AUTH0_DOMAIN=your-tenant.eu.auth0.com

# [OPTIONAL] Auth0 client ID for frontend
NEXT_PUBLIC_AUTH0_CLIENT_ID=your-auth0-client-id

# [OPTIONAL] Auth0 audience for frontend
NEXT_PUBLIC_AUTH0_AUDIENCE=https://api.festivals.app


# ==============================================================================
# MOBILE APP (Expo/React Native)
# ==============================================================================

# [REQUIRED] Backend API URL for mobile app
# Note: For Android emulator use 10.0.2.2, for physical device use local IP
EXPO_PUBLIC_API_URL=http://localhost:8080

# [OPTIONAL] Auth0 settings for mobile
EXPO_PUBLIC_AUTH0_DOMAIN=your-tenant.eu.auth0.com
EXPO_PUBLIC_AUTH0_CLIENT_ID=your-mobile-auth0-client-id
EXPO_PUBLIC_AUTH0_AUDIENCE=https://api.festivals.app

# [OPTIONAL] Stripe publishable key for mobile payments
EXPO_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key


# ==============================================================================
# EXTERNAL SERVICES
# ==============================================================================

# [OPTIONAL] Google Maps API key (for maps in admin/mobile)
GOOGLE_MAPS_API_KEY=your-google-maps-api-key

# [OPTIONAL] Mapbox access token (alternative to Google Maps)
MAPBOX_ACCESS_TOKEN=your-mapbox-access-token

# [OPTIONAL] Cloudflare settings (if using Cloudflare)
CLOUDFLARE_API_TOKEN=your-cloudflare-api-token
CLOUDFLARE_ZONE_ID=your-cloudflare-zone-id


# ==============================================================================
# DEVELOPMENT / TESTING
# ==============================================================================

# [OPTIONAL] Enable hot reload for backend
HOT_RELOAD=true

# [OPTIONAL] Test database URL (separate from development)
TEST_DATABASE_URL=postgres://festivals:password@localhost:5432/festivals_test?sslmode=disable

# [OPTIONAL] Seed database with sample data on startup
SEED_DATABASE=false

# [OPTIONAL] Enable request/response logging
REQUEST_LOGGING=true
